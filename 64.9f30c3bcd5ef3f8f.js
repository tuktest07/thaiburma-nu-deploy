"use strict";(self.webpackChunksol=self.webpackChunksol||[]).push([[64],{8064:(et,U,a)=>{a.r(U),a.d(U,{AuthSignInModule:()=>tt});var g=a(2791),b=a(8834),T=a(2765),f=a(2102),A=a(9213),F=a(9042),y=a(9183),$=a(4271),S=a(6522),x=a(11),c=a(9417),d=a(5781),D=a(130),E=a(5312),G=a(1413),I=a(6977),t=a(4438),v=a(2608),C=a(945),l=a(6354),u=a(9437),m=a(7673),j=a(5683),k=a(1626);let w=(()=>{class o{constructor(s){this.http=s,this.baseUrl=E.c.apiUrl,this.tools=new j.S}login(s,e){const n=`${this.baseUrl}/auth/login`,i=this.tools.GenFormData({userId:s,photoUrl:e});return this.http.post(n,i).pipe((0,l.T)(r=>r?.status?r.data:r?.message||"Sign in failure"),(0,u.W)(r=>(0,m.of)(r)))}signIn(s,e,n){const i=`${this.baseUrl}/auth/signin`,r=this.tools.GenFormData({socialId:s,socialImg:e,level:n});return this.http.post(i,r).pipe((0,l.T)(h=>h?.status?h.data:h?.message||"Sign in failure"),(0,u.W)(h=>(0,m.of)(h)))}testerSignIn(s){const e=`${this.baseUrl}/auth/signin`,n=this.tools.GenFormData(s);return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}register(s){const e=`${this.baseUrl}/auth/register`,n=this.tools.GenFormData(s);return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}myProfile(){return this.http.get(`${this.baseUrl}/auth/my-profile`).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}allUsers(s){return this.http.post(`${this.baseUrl}/auth/users/all`,null).pipe((0,l.T)(n=>n.data),(0,u.W)(n=>(0,m.of)(n)))}allUsersVerified(s){return this.http.get(`${this.baseUrl}/auth/users-verified${s?`/${s}`:""}`).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}setPermission(s,e){const n=`${this.baseUrl}/auth/setPermission`,i=this.tools.GenFormData({status:s,socialId:e});return this.http.post(n,i).pipe((0,l.T)(r=>r.data),(0,u.W)(r=>(0,m.of)(r)))}getStructureDOH(){return this.http.post(`${this.baseUrl}/auth/getStructureDOH`,null).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}update(s){return this.http.post(`${this.baseUrl}/auth/update`,s).pipe((0,l.T)(n=>n.data),(0,u.W)(n=>(0,m.of)(n)))}profileUser(){return this.http.get(`${this.baseUrl}/auth/profileUser`).pipe((0,l.T)(e=>e?.status?e.data:e),(0,u.W)(e=>(0,m.of)(e)))}listUserByDepartment(s){return this.http.post(`${this.baseUrl}/auth/listUserByDepartment`,s).pipe((0,l.T)(n=>n.data),(0,u.W)(n=>(0,m.of)(n)))}updateProfile(s){return this.http.post(`${this.baseUrl}/auth/updateProfile`,s).pipe((0,l.T)(n=>n.data),(0,u.W)(n=>(0,m.of)(n)))}deleteProfile(s){return this.http.post(`${this.baseUrl}/auth/deleteProfile`,s)}updateProfileUser(s){return this.http.post(`${this.baseUrl}/auth/updateProfileUser`,s)}getUserNoProfile(){return this.http.get(`${this.baseUrl}/auth/userNoProfile`).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}mpsat3AdminUserRole(){return this.http.get(`${this.baseUrl}/auth/mpsat3/user-permission`).pipe((0,l.T)(e=>"string"!=typeof e?.data&&(e?.data||!1)),(0,u.W)(e=>(0,m.of)(e)))}mpsat3UserUpdateRole(s,e,n){return this.http.put(`${this.baseUrl}/auth/mpsat3/user-permission`,{user_id:s,department_id:e,role:n}).pipe((0,l.T)(r=>r.data),(0,u.W)(r=>(0,m.of)(r)))}mpsat3UserUpdateDepartment(s,e){return this.http.put(`${this.baseUrl}/auth/mpsat3/user-permission-department`,{user_id:s,department_id:e}).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}getDepartments(){return this.http.get(`${this.baseUrl}/auth/system-departs`).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}getProjectInDepart(s,e){return this.http.get(`${this.baseUrl}/auth/project-depart/${s}/${e}`).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}userPassSignIn(s,e){const n=`${this.baseUrl}/auth/login`,i=this.tools.GenFormData({email:s,password:e});return this.http.post(n,i).pipe((0,l.T)(r=>r.data),(0,u.W)(r=>(0,m.of)(r)))}userPassSignUp(s){const e=`${this.baseUrl}/auth/signup-user-pass`,n=this.tools.GenFormData(s);return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}resetUserPass(s){const e=`${this.baseUrl}/auth/reset-user-pass`,n=this.tools.GenFormData({email:s});return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}resetMyPassword(s,e){const n=`${this.baseUrl}/auth/reset-my-password`,i=this.tools.GenFormData({key:s,newPass:e});return this.http.post(n,i).pipe((0,l.T)(r=>r.data),(0,u.W)(r=>(0,m.of)(r)))}getRoles(){return this.http.get(`${this.baseUrl}/auth/listRoles`).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}RolesUpdate(s){const e=`${this.baseUrl}/auth/updateRoles`,n=this.tools.GenFormData(s);return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}listAllUser(){return this.http.get(`${this.baseUrl}/auth/listAllUser`).pipe((0,l.T)(e=>e.data),(0,u.W)(e=>(0,m.of)(e)))}updateRolesAndApprovalUser(s){const e=`${this.baseUrl}/auth/updateRolesAndApprovalUser`,n=this.tools.GenFormData(s);return this.http.post(e,n).pipe((0,l.T)(i=>i.data),(0,u.W)(i=>(0,m.of)(i)))}static{this.\u0275fac=function(e){return new(e||o)(t.KVO(k.Qq))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var R=a(895),N=a(177);const W=["signInNgForm"],Y=()=>["/forgot-password"],P=o=>[o],B=()=>["/sign-up/"];function L(o,p){if(1&o&&(t.qex(0),t.j41(1,"a",36),t.EFF(2," \u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19 "),t.k0s(),t.bVm()),2&o){const s=t.XpG();t.R7$(),t.Y8G("routerLink",t.eq3(1,P,"/sign-up/"+s.comId))}}function V(o,p){1&o&&(t.j41(0,"a",36),t.EFF(1," \u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19 "),t.k0s()),2&o&&t.Y8G("routerLink",t.lJ4(1,B))}function X(o,p){if(1&o&&(t.j41(0,"sol-alert",37),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.Y8G("appearance","outline")("showIcon",!1)("type",s.alert.type)("@shake","error"===s.alert.type),t.R7$(),t.SpI(" ",s.alert.message," ")}}function Q(o,p){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Email address is required "),t.k0s())}function z(o,p){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Please enter a valid email address "),t.k0s())}function O(o,p){1&o&&t.nrm(0,"mat-icon",38),2&o&&t.Y8G("svgIcon","heroicons_solid:eye")}function H(o,p){1&o&&t.nrm(0,"mat-icon",38),2&o&&t.Y8G("svgIcon","heroicons_solid:eye-off")}function J(o,p){1&o&&(t.j41(0,"strong"),t.EFF(1," \u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e23\u0e30\u0e1a\u0e1a "),t.k0s())}function M(o,p){1&o&&t.nrm(0,"mat-progress-spinner",39),2&o&&t.Y8G("diameter",24)("mode","indeterminate")}function K(o,p){1&o&&(t.j41(0,"span"),t.EFF(1," Sign in Test "),t.k0s())}function Z(o,p){1&o&&t.nrm(0,"mat-progress-spinner",39),2&o&&t.Y8G("diameter",24)("mode","indeterminate")}function _(o,p){if(1&o){const s=t.RV6();t.j41(0,"button",40),t.bIt("click",function(){t.eBV(s);const n=t.XpG();return t.Njj(n.TestSignIn())}),t.DNE(1,K,2,0,"span",27)(2,Z,1,2,"mat-progress-spinner",34),t.k0s()}if(2&o){const s=t.XpG();t.Y8G("color","warn")("disabled",s.signInForm.disabled),t.R7$(),t.Y8G("ngIf",!s.signInForm.disabled),t.R7$(),t.Y8G("ngIf",s.signInForm.disabled)}}const q=[{path:"",component:(()=>{class o{constructor(s,e,n,i,r,h){this._activatedRoute=s,this._router=e,this._formBuilder=n,this.socialService=i,this._authService=r,this._userConn=h,this.isDev=!E.c.production,this.alert={type:"success",message:""},this.showAlert=!1,this._unsubscribeAll=new G.B}ngOnInit(){let s=!E.c.production;this.signInForm=this._formBuilder.group({email:[s?"hughes.brian@company.com":null,[c.k0.required,c.k0.email]],password:[s?"admin":null,c.k0.required]}),this.initLine(),this.socialService.authState.pipe((0,I.Q)(this._unsubscribeAll)).subscribe(e=>{e?.id&&this.SocialContinue(e.id,e.photoUrl,{social:e.provider,socialId:e.id,profileImage:e.photoUrl,name:`${e.firstName} ${e.lastName}`,email:e.email,firstname:e.firstName,lastname:e.lastName})})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.unsubscribe()}LINELiffAuth(){console.log("LINELiffAuth"),d.A.login()}initLine(){d.A.init({liffId:E.c.AUTH_KEYS.LINE_LIFF_ID},()=>{d.A.isLoggedIn()&&this.runApp()},s=>console.error(s))}runApp(){d.A.getIDToken(),d.A.getProfile().then(e=>{console.log(e),e?.userId&&this.SocialContinue(e.userId,e.pictureUrl,{social:"line",socialId:e.userId,profileImage:e.pictureUrl,name:e.displayName,email:e?.email||null})}).catch(e=>console.error(e))}SocialContinue(s,e,n){this._userConn.login(s,e).pipe((0,I.Q)(this._unsubscribeAll)).subscribe({next:i=>{console.log("login",i),i?.id?!i?.id||i?.status?i?.id&&(this._authService.setUserCookie(i),this._router.navigateByUrl("/")):this._router.navigateByUrl("/confirmation-required"):this._router.navigateByUrl("/sign-up",{replaceUrl:!0,state:n})},error:i=>{this.showAlert=!0,this.alert.message=i.message,this.alert.type="error"}})}signIn(){"aofxta"!==this.signInForm.get("email").value&&"admin"!==this.signInForm.get("email").value&&this.signInForm.invalid||(this.signInForm.disable(),this.showAlert=!1,setTimeout(()=>{this.signInForm.enable()},3e3),this._authService.UserPassLogin(this.signInForm.value).pipe((0,I.Q)(this._unsubscribeAll)).subscribe({next:s=>{if("string"==typeof s)return this.showAlert=!0,this.alert.message=s,void(this.alert.type="warning");console.log("%c::-user-::","color:orange",s),this._authService.setUserCookie(s),this._router.navigateByUrl("/dashboard",{replaceUrl:!0})},error:s=>{this.showAlert=!0,this.alert.message=s.error,this.alert.type="warning"}}))}getCompanyProfile(){this._authService.getCompanyProfile({com_id:this.comId}).pipe((0,I.Q)(this._unsubscribeAll)).subscribe(e=>{console.log("getCompanyProfile",e),e&&(this.ActiveCompany=e)})}TestSignIn(){this._router.navigateByUrl("/dashboard")}static{this.\u0275fac=function(e){return new(e||o)(t.rXU(g.nX),t.rXU(g.Ix),t.rXU(c.ze),t.rXU(v.Jn),t.rXU(C.u),t.rXU(w))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["auth-sign-in"]],viewQuery:function(e,n){if(1&e&&t.GBs(W,5),2&e){let i;t.mGM(i=t.lsd())&&(n.signInNgForm=i.first)}},decls:54,vars:17,consts:[["elseTemplate",""],["signInNgForm","ngForm"],["passwordField",""],[1,"flex","flex-col","flex-auto","items-center","justify-center","min-w-0","md:p-8"],[1,"flex","sm:rounded-2xl","sm:shadow","overflow-hidden","sm:bg-card"],[1,"w-full","sm:w-auto","py-8","px-4","sm:p-12","md:p-16"],[1,"w-full","max-w-80","sm:w-80","mx-auto","sm:mx-0"],[1,"flex","flex-row","gap-3"],[1,"flex","flex-0","w-12"],["src","assets/images/logo/logo.svg"],[1,"flex","flex-1","flex-col"],[1,"text-4xl","font-extrabold","tracking-tight","leading-tight"],[1,"flex","items-baseline","mt-0.5","font-medium"],[4,"ngIf","ngIfElse"],["class","mt-8 -mb-4",3,"appearance","showIcon","type",4,"ngIf"],[1,"flex","flex-col","items-center","mt-4","space-y-3"],[1,"flex","w-full"],["type","button","mat-stroked-button","",1,"relative","w-80","bg-green-600",3,"click"],[1,"absolute","left-2","icon-size-5"],["src","assets/icons/icon-line.svg",1,"icon-size-5"],[1,"tracking-wider","text-white"],[1,"flex","items-center","mt-4"],[1,"flex-auto","mt-px","border-t"],[1,"mx-2","text-secondary"],[1,"mt-4",3,"formGroup"],[1,"w-full"],["id","email","matInput","",3,"formControlName"],[4,"ngIf"],["id","password","matInput","","type","password",3,"formControlName"],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"inline-flex","items-center","justify-between","w-full","mt-1.5"],[1,"text-md","font-medium","text-primary-500","hover:underline",3,"routerLink"],["mat-flat-button","",1,"sol-mat-button-large","w-full","mt-4",3,"click","color","disabled"],[3,"diameter","mode",4,"ngIf"],["class","sol-mat-button-large w-full mt-6","mat-flat-button","",3,"color","disabled","click",4,"ngIf"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"mt-8","-mb-4",3,"appearance","showIcon","type"],[1,"icon-size-5",3,"svgIcon"],[3,"diameter","mode"],["mat-flat-button","",1,"sol-mat-button-large","w-full","mt-6",3,"click","color","disabled"]],template:function(e,n){if(1&e){const i=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8),t.nrm(6,"img",9),t.k0s(),t.j41(7,"div",10)(8,"div",11),t.EFF(9,"\u0e40\u0e02\u0e49\u0e32\u0e2a\u0e39\u0e48\u0e23\u0e30\u0e1a\u0e1a"),t.k0s(),t.j41(10,"div",12)(11,"div"),t.EFF(12,"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e21\u0e35\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e43\u0e0a\u0e48\u0e44\u0e2b\u0e21?"),t.k0s(),t.DNE(13,L,3,3,"ng-container",13)(14,V,2,2,"ng-template",null,0,t.C5r),t.k0s()()(),t.DNE(16,X,2,5,"sol-alert",14),t.j41(17,"div",15)(18,"div",16)(19,"button",17),t.bIt("click",function(){return t.eBV(i),t.Njj(n.LINELiffAuth())}),t.j41(20,"mat-icon",18),t.nrm(21,"img",19),t.k0s(),t.j41(22,"strong",20),t.EFF(23,"Sign in with LINE"),t.k0s()()()(),t.j41(24,"div",21),t.nrm(25,"div",22),t.j41(26,"div",23),t.EFF(27," Or sign with Email"),t.k0s(),t.nrm(28,"div",22),t.k0s(),t.j41(29,"form",24,1)(31,"mat-form-field",25)(32,"mat-label"),t.EFF(33,"Username"),t.k0s(),t.nrm(34,"input",26),t.DNE(35,Q,2,0,"mat-error",27)(36,z,2,0,"mat-error",27),t.k0s(),t.j41(37,"mat-form-field",25)(38,"mat-label"),t.EFF(39,"Password"),t.k0s(),t.nrm(40,"input",28,2),t.j41(42,"button",29),t.bIt("click",function(){t.eBV(i);const h=t.sdS(41);return t.Njj(h.type="password"===h.type?"text":"password")}),t.DNE(43,O,1,1,"mat-icon",30)(44,H,1,1,"mat-icon",30),t.k0s(),t.j41(45,"mat-error"),t.EFF(46," Password is required "),t.k0s()(),t.j41(47,"div",31)(48,"a",32),t.EFF(49,"\u0e25\u0e37\u0e21\u0e23\u0e2b\u0e31\u0e2a\u0e1c\u0e48\u0e32\u0e19\u0e43\u0e0a\u0e48\u0e2b\u0e23\u0e37\u0e2d\u0e44\u0e21\u0e48 ? "),t.k0s()(),t.j41(50,"button",33),t.bIt("click",function(){return t.eBV(i),t.Njj(n.signIn())}),t.DNE(51,J,2,0,"strong",27)(52,M,1,2,"mat-progress-spinner",34),t.k0s(),t.DNE(53,_,3,4,"button",35),t.k0s()()()()()}if(2&e){const i=t.sdS(15),r=t.sdS(41);t.R7$(13),t.Y8G("ngIf",n.comId)("ngIfElse",i),t.R7$(3),t.Y8G("ngIf",n.showAlert),t.R7$(13),t.Y8G("formGroup",n.signInForm),t.R7$(5),t.Y8G("formControlName","email"),t.R7$(),t.Y8G("ngIf",n.signInForm.get("email").hasError("required")),t.R7$(),t.Y8G("ngIf",n.signInForm.get("email").hasError("email")),t.R7$(4),t.Y8G("formControlName","password"),t.R7$(3),t.Y8G("ngIf","password"===r.type),t.R7$(),t.Y8G("ngIf","text"===r.type),t.R7$(4),t.Y8G("routerLink",t.lJ4(16,Y)),t.R7$(2),t.Y8G("color","primary")("disabled",n.signInForm.disabled),t.R7$(),t.Y8G("ngIf",!n.signInForm.disabled),t.R7$(),t.Y8G("ngIf",n.signInForm.disabled),t.R7$(),t.Y8G("ngIf",n.isDev)}},dependencies:[g.Wk,b.$z,b.iY,f.rl,f.nJ,f.TL,f.yw,A.An,F.fg,y.LG,R.A,N.bT,c.qT,c.me,c.BC,c.cb,c.j4,c.JD],encapsulation:2,data:{animation:D.Y}})}}return o})()}];let tt=(()=>{class o{static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[g.iI.forChild(q),b.Hl,T.g7,f.RG,A.m_,F.fS,y.D6,$.Z,S.xG,x.G,v.BD,v.AV]})}}return o})()}}]);